import{a as L,b as W,r as D,w as P,e as N,f as E,h as f,t as R,u as O,i as V,o as A}from"./entry.00b89c4a.js";const U={class:"h-full select-none"},j=f("canvas",{id:"scene",class:"z-0 w-full h-full",style:{"image-rendering":"pixelated"}},null,-1),q={class:"fixed top-6 right-4 text-black"},J={class:"fixed top-5 right-5"},Q={key:0},Z=f("p",{class:"fixed top-11 right-4 text-black text-lg"},"Game over",-1),$=f("p",{class:"fixed top-10 right-5 text-lg"},"Game over",-1),tt=f("p",{class:"fixed top-16 right-4 text-black text-xs"},"Press X to restart",-1),et=f("p",{class:"fixed top-16 right-5 text-xs"},"Press X to restart",-1),ot=[Z,$,tt,et],nt=L({__name:"index",async setup(at){let _,M;W({title:"1D Minesweeper"});let o=16,d=Math.floor(window.innerWidth/64),h=Math.floor(window.innerHeight/64),i,r;const X=D(0);let x=D(!1);const b=new Image;b.src="./assets/floor.png",[_,M]=P(()=>new Promise(e=>{b.onload=()=>e(1)})),await _,M();const I=new Image;I.src="./assets/food_atlas.png",[_,M]=P(()=>new Promise(e=>{I.onload=()=>e(1)})),await _,M();const c={velocityX:0,velocityY:0},t={x:0,y:0,velocityX:0,velocityY:0,tail:[],maxTail:1},n={index:0,x:1,y:1};N(async()=>{i=document.getElementById("scene"),i.height=h*o,i.width=d*o,r=i.getContext("2d"),await g(),document.addEventListener("keydown",B),window.addEventListener("resize",G),setInterval(function(){C()},100)});function G(){d=Math.floor(window.innerWidth/64),h=Math.floor(window.innerHeight/64),i.height=h*o,i.width=d*o,n.x>d-1&&g(),n.y>h-1&&g(),C()}async function C(){x.value||(r.drawImage(b,0,0,i.width,i.height),r.drawImage(I,n.index*o,0,o,o,n.x*o,n.y*o,o,o),t.velocityX=c.velocityX,t.velocityY=c.velocityY,t.x+=t.velocityX,t.y+=t.velocityY,t.x<0?t.x=d-1:t.x>d-1&&(t.x=0),t.y<0?t.y=h-1:t.y>h-1&&(t.y=0),t.tail.unshift({x:t.x,y:t.y}),t.tail.length>t.maxTail&&t.tail.pop(),r.fillStyle="white",t.tail.forEach(function(e,l){r.fillRect(e.x*o,e.y*o,o,o),e.x===n.x&&e.y===n.y&&(t.maxTail++,X.value++,t.tail.push([n.x,n.y]),g());for(let a=l+1;a<t.tail.length;a++)e.x==t.tail[a].x&&e.y==t.tail[a].y&&z()}),K())}async function K(){const e=Math.floor(Math.random()*10+120),l=document.createElement("canvas");l.width=i.width,l.height=i.height;const a=l.getContext("2d");a.fillStyle="black",a.fillRect(0,0,i.width,i.height);const s=t.x*o+o/2,u=t.y*o+o/2;let v=a.createRadialGradient(s,u,0,s,u,e);v.addColorStop(0,"rgba(255, 255, 255, 255)"),v.addColorStop(1,"rgba(255, 255, 255, 0)"),a.beginPath(),a.fillStyle=v,a.arc(s,u,e,0,2*Math.PI),a.fill();const w=n.x*o+o/2,Y=n.y*o+o/2;let p=a.createRadialGradient(w,Y,0,w,Y,e/2);p.addColorStop(0,"rgba(255, 255, 255, 255)"),p.addColorStop(1,"rgba(255, 255, 255, 0)"),a.fillStyle=p,a.arc(w,Y,e/2,0,2*Math.PI),a.fill();let m=r.getImageData(0,0,i.width,i.height),H=a.getImageData(0,0,l.width,l.height);for(let y=0;y<m.data.length;y+=4){const k=H.data[y]/255;m.data[y]*=k,m.data[y+1]*=k,m.data[y+2]*=k}r.putImageData(m,0,0);let S=r.getImageData(0,0,i.width,i.height);S=T(S,128),r.putImageData(S,0,0)}function T(e,l){const a=[[15,135,45,165],[195,75,225,105],[60,180,30,150],[240,120,210,90]];for(let s=0;s<e.data.length;s+=4){const u=e.data[s]*.299+e.data[s+1]*.587+e.data[s+2]*.114,v=s/4%e.width,w=Math.floor(s/4/e.width),p=Math.floor((u+a[v%4][w%4])/2)<l?0:255;e.data.fill(p,s,s+3)}return e}async function g(){let e=!1;for(;!e;)n.x=Math.floor(Math.random()*d),n.y=Math.floor(Math.random()*h),e=!0,t.tail.forEach(function(l){l.x===n.x&&l.y===n.y&&(e=!1)});n.index=Math.floor(Math.random()*5)}function B(e){(e.code==="ArrowUp"||e.code==="KeyW")&&t.velocityY!=1?(c.velocityX=0,c.velocityY=-1):(e.code==="ArrowDown"||e.code==="KeyS")&&t.velocityY!=-1?(c.velocityX=0,c.velocityY=1):(e.code==="ArrowLeft"||e.code==="KeyA")&&t.velocityX!=1?(c.velocityX=-1,c.velocityY=0):(e.code==="ArrowRight"||e.code==="KeyD")&&t.velocityX!=-1&&(c.velocityX=1,c.velocityY=0),x.value&&e.code==="KeyX"&&F()}async function z(){x.value=!0}async function F(){X.value=0,x.value=!1,t.x=t.y=t.velocityX=t.velocityY=0,t.maxTail=1,t.tail=[],c.velocityX=c.velocityY=0,g()}return(e,l)=>(A(),E("div",U,[j,f("p",q,"Score: "+R(X.value),1),f("p",J,"Score: "+R(X.value),1),O(x)?(A(),E("div",Q,ot)):V("",!0)]))}});export{nt as default};
