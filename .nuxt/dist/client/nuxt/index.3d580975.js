import{a as k,b as A,r as P,w as M,e as B,f as E,h as R,t as K,o as F}from"./entry.5b31af7b.js";const G={class:"flex justify-center flex-wrap flex-col items-center min-w-[300px] select-none"},L=R("canvas",{id:"scene",class:"w-[95vw]",style:{"image-rendering":"pixelated"}},null,-1),z=k({__name:"index",async setup(O){let y,f;A({title:"1D Minesweeper"});let a=10,g=20,u=20,n,c;const w=P(0);let I=!1;const m=new Image;m.src="./floor.png",[y,f]=M(()=>new Promise(e=>{m.onload=()=>e(1)})),await y,f();const v=new Image;v.src="./food.png",[y,f]=M(()=>new Promise(e=>{v.onload=()=>e(1)})),await y,f();const t={x:0,y:0,velocityX:0,velocityY:0,tail:[]},l={x:0,y:0};B(async()=>{n=document.getElementById("scene"),n.height=g*a,n.width=u*a,c=n.getContext("2d"),await S(),document.addEventListener("keydown",X),setInterval(b,66.67)});async function b(){if(!I){c.drawImage(m,0,0),c.drawImage(v,l.x,l.y),t.x===l.x&&t.y===l.y&&(t.tail.push([l.x,l.y]),S());for(let e=t.tail.length-1;e>0;e--)t.tail[e]=t.tail[e-1];t.tail.length&&(t.tail[0]=[t.x,t.y]),t.x+=t.velocityX*a,t.y+=t.velocityY*a,t.x<0&&(t.x=(u-1)*a),t.x>(u-1)*a&&(t.x=0),t.y<0&&(t.y=(g-1)*a),t.y>(g-1)*a&&(t.y=0),c.fillStyle="white",c.fillRect(t.x,t.y,a,a),c.fillStyle="rgb(237, 230, 204)";for(let e=0;e<t.tail.length;e++)c.fillRect(t.tail[e][0],t.tail[e][1],a,a);for(let e=0;e<t.tail.length;e++)t.x===t.tail[e][0]&&t.y===t.tail[e][1]&&Y();C()}}async function C(){const r=document.createElement("canvas");r.width=n.width,r.height=n.height;const i=r.getContext("2d");i.fillStyle="black",i.fillRect(0,0,n.width,n.height);let o=i.createRadialGradient(t.x,t.y,0,t.x,t.y,125);o.addColorStop(0,"rgba(255, 255, 255, 255)"),o.addColorStop(1,"rgba(255, 255, 255, 0)"),i.beginPath(),i.fillStyle=o,i.arc(t.x,t.y,125,0,2*Math.PI),i.fill();let h=i.createRadialGradient(l.x,l.y,0,l.x,l.y,125/2);h.addColorStop(0,"rgba(255, 255, 255, 255)"),h.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=h,i.arc(l.x,l.y,125/2,0,2*Math.PI),i.fill();let d=c.getImageData(0,0,n.width,n.height),p=i.getImageData(0,0,r.width,r.height);for(let s=0;s<d.data.length;s+=4){const _=p.data[s]/255;d.data[s]*=_,d.data[s+1]*=_,d.data[s+2]*=_}c.putImageData(d,0,0);let x=c.getImageData(0,0,n.width,n.height);x=D(x,128),c.putImageData(x,0,0)}function D(e,r){const i=[[15,135,45,165],[195,75,225,105],[60,180,30,150],[240,120,210,90]];for(let o=0;o<e.data.length;o+=4){const h=e.data[o]*.299+e.data[o+1]*.587+e.data[o+2]*.114,d=o/4%e.width,p=Math.floor(o/4/e.width),s=Math.floor((h+i[d%4][p%4])/2)<r?0:255;e.data.fill(s,o,o+3)}return e}async function S(){l.x=Math.floor(Math.random()*u)*a,l.y=Math.floor(Math.random()*g)*a,w.value++}function X(e){(e.code==="ArrowUp"||e.code==="KeyW")&&t.velocityY!=1?(t.velocityX=0,t.velocityY=-1):(e.code==="ArrowDown"||e.code==="KeyS")&&t.velocityY!=-1?(t.velocityX=0,t.velocityY=1):(e.code==="ArrowLeft"||e.code==="KeyA")&&t.velocityX!=1?(t.velocityX=-1,t.velocityY=0):(e.code==="ArrowRight"||e.code==="KeyD")&&t.velocityX!=-1&&(t.velocityX=1,t.velocityY=0)}async function Y(){I=!0,w.value=0,t.tail=[]}return(e,r)=>(F(),E("div",G,[R("p",null,"Score: "+K(w.value),1),L]))}});export{z as default};
